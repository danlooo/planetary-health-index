filter((X == x_sphere & Y == y_sphere) | (X==y_sphere & Y == x_sphere)) |>
select(X, Y, scores) |>
unnest(scores) |>
unite(comp, X, Y)
ccas |>
filter((X == x_sphere & Y == y_sphere) | (X==y_sphere & Y == x_sphere)) |>
select(X, Y, scores) |>
unnest(scores) |>
unite(comp, X, Y) |>
ggplot(aes(CCA1, CCA2)) +
geom_point() +
facet_wrap(~comp)
highlight_func <- ~ filter(.x, str_detect(geo, "BE"))
ccas |>
filter((X == x_sphere & Y == y_sphere) | (X==y_sphere & Y == x_sphere)) |>
select(X, Y, scores) |>
unnest(scores) |>
unite(comp, X, Y) |>
ggplot(aes(CCA1, CCA2)) +
geom_point(color = "darkgrey", alpha = 0.03) +
geom_point(
data = highlight_func,
color = "#006c66",
alpha = 0.3,
size = 1
) +
geom_density_2d(
data = highlight_func,
color = "#006c66"
) +
geom_density_2d(color = "#333333") +
facet_wrap(~comp)
ccas |>
filter((X == x_sphere & Y == y_sphere) | (X==y_sphere & Y == x_sphere)) |>
select(X, Y, scores) |>
unnest(scores) |>
unite(comp, X, Y) |>
ggplot(aes(CCA1, CCA2)) +
geom_point(color = "darkgrey", alpha = 0.03) +
geom_point(
data = highlight_func,
color = "#006c66",
alpha = 0.3,
size = 1
) +
geom_density_2d(
data = highlight_func,
color = "#006c66"
) +
geom_density_2d(color = "#333333") +
facet_wrap(~comp)
ccas |>
filter((X == x_sphere & Y == y_sphere) | (X==y_sphere & Y == x_sphere)) |>
select(X, Y, scores) |>
unnest(scores) |>
unite(comp, X, Y) |>
ggplot(aes(CCA1, CCA2)) +
geom_point(
data = ~ sample_n(.x, 1000),
color = "darkgrey",
alpha = 0.03
) +
geom_point(
data = highlight_func,
color = "#006c66",
alpha = 0.3,
size = 1
) +
geom_density_2d(
data = highlight_func,
color = "#006c66"
) +
geom_density_2d(color = "#333333") +
facet_wrap(~comp)
ccas |>
filter((X == x_sphere & Y == y_sphere) | (X==y_sphere & Y == x_sphere)) |>
select(X, Y, scores) |>
unnest(scores) |>
unite(comp, X, Y) |>
ggplot(aes(CCA1, CCA2)) +
geom_point(
data = ~ sample_n(.x, 1000),
color = "darkgrey",
alpha = 0.03
) +
geom_point(
data = highlight_func,
color = "#006c66",
alpha = 0.3,
size = 1
) +
geom_density_2d(
data = highlight_func,
color = "#006c66"
) +
geom_density_2d(color = "#333333") +
facet_wrap(~comp)
ccas |>
filter((X == x_sphere & Y == y_sphere) | (X==y_sphere & Y == x_sphere)) |>
select(X, Y, scores) |>
unnest(scores) |>
unite(comp, X, Y) |>
ggplot(aes(CCA1, CCA2)) +
geom_point(
#data = ~ sample_n(.x, 1000),
color = "darkgrey",
alpha = 0.03
) +
geom_point(
data = highlight_func,
color = "#006c66",
alpha = 0.3,
size = 1
) +
geom_density_2d(
data = highlight_func,
color = "#006c66"
) +
geom_density_2d(color = "#333333") +
facet_wrap(~comp)
ccas |>
filter((X == x_sphere & Y == y_sphere) | (X==y_sphere & Y == x_sphere)) |>
select(X, Y, scores) |>
unnest(scores) |>
unite(comp, X, Y) |>
ggplot(aes(CCA1, CCA2)) +
geom_point(
color = "darkgrey",
alpha = 0.03
) +
geom_point(
data = highlight_func,
color = "#006c66",
alpha = 0.3,
size = 1
) +
geom_density_2d(
data = highlight_func,
color = "#006c66"
) +
geom_density_2d(color = "#333333") +
facet_wrap(~comp)
scores_plt | loadings_plt
scores_plt <-
ccas |>
filter((X == x_sphere & Y == y_sphere) | (X==y_sphere & Y == x_sphere)) |>
select(X, Y, scores) |>
unnest(scores) |>
unite(comp, X, Y) |>
select(comp, CCA1, geo, time) |>
pivot_wider(names_from = comp, values_from = CCA1) |>
left_join(nuts3_regions, by = c("geo" = "geo3")) |>
mutate(time = yq(time)) |>
ggplot(aes_string(paste(x_sphere, y_sphere, sep = "_"),  paste(y_sphere, x_sphere, sep = "_"))) +
geom_point(color = "darkgrey", alpha = 0.03) +
geom_point(
data = highlight_func,
color = "#006c66",
alpha = 0.3,
size = 1
) +
geom_density_2d(
data = highlight_func,
color = "#006c66"
) +
geom_density_2d(color = "#333333") +
guides(fill = "none") +
labs(
title = "Canonical Correlation Scores",
subtitle = "First component, highlighted Belgium"
)
loadings_plt <-
ccas |>
filter((X == x_sphere & Y == y_sphere) | (X==y_sphere & Y == x_sphere)) |>
select(X, Y, loadings) |>
unnest(loadings) |>
unite(comp, X, Y) |>
ggplot(aes(var, CCA1)) +
geom_bar(
stat = "identity",
#  position = position_dodge2(preserve = "single")
) +
coord_flip() +
#facet_wrap(~ comp, ncol=1,scales="free") +
facet_grid(comp ~ ., scales = "free_y", space = "free_y") +
labs(
x = "Feature",
y = "Loading",
title = paste0("Canonical Correlation Loadings ", paste(x_sphere, y_sphere, sep = "_"))
)
scores_plt | loadings_plt
ccas |>
filter((X == x_sphere & Y == y_sphere) | (X==y_sphere & Y == x_sphere)) |>
select(X, Y, scores) |>
unnest(scores) |>
unite(comp, X, Y) |>
ggplot(aes(CCA1, CCA2)) +
geom_point(
color = "darkgrey",
alpha = 0.03
) +
geom_point(
data = highlight_func,
color = "#006c66",
alpha = 0.3,
size = 1
) +
geom_density_2d(
data = highlight_func,
color = "#006c66"
) +
geom_density_2d(color = "#333333") +
facet_wrap(~comp)
ccas |>
filter((X == x_sphere & Y == y_sphere) | (X==y_sphere & Y == x_sphere)) |>
select(X, Y, scores) |>
unnest(scores) |>
unite(comp, X, Y) |>
ggplot(aes(CCA1, CCA2)) +
geom_point(
color = "darkgrey",
alpha = 0.03
) +
geom_point(
data = highlight_func,
color = "#006c66",
alpha = 0.3,
size = 1
) +
geom_density_2d(
data = highlight_func,
color = "#006c66"
) +
geom_density_2d(color = "#333333") +
facet_wrap(~comp) +
labs(title = "Canonical Correlation trajectories", subtitle = "highlighted Belgium")
scores_plt | loadings_plt
scores_plt <-
ccas |>
filter((X == x_sphere & Y == y_sphere) | (X==y_sphere & Y == x_sphere)) |>
select(X, Y, scores) |>
unnest(scores) |>
unite(comp, X, Y) |>
select(comp, CCA1, geo, time) |>
pivot_wider(names_from = comp, values_from = CCA1) |>
left_join(nuts3_regions, by = c("geo" = "geo3")) |>
mutate(time = yq(time)) |>
ggplot(aes_string(paste(x_sphere, y_sphere, sep = "_"),  paste(y_sphere, x_sphere, sep = "_"))) +
geom_point(color = "darkgrey", alpha = 0.03) +
geom_point(
data = highlight_func,
color = "#006c66",
alpha = 0.3,
size = 1
) +
geom_density_2d(
data = highlight_func,
color = "#006c66"
) +
geom_density_2d(color = "#333333") +
guides(fill = "none") +
labs(
title = "Canonical Correlation Scores",
subtitle = "First component"
)
scores_plt <-
ccas |>
filter((X == x_sphere & Y == y_sphere) | (X==y_sphere & Y == x_sphere)) |>
select(X, Y, scores) |>
unnest(scores) |>
unite(comp, X, Y) |>
select(comp, CCA1, geo, time) |>
pivot_wider(names_from = comp, values_from = CCA1) |>
left_join(nuts3_regions, by = c("geo" = "geo3")) |>
mutate(time = yq(time)) |>
ggplot(aes_string(paste(x_sphere, y_sphere, sep = "_"),  paste(y_sphere, x_sphere, sep = "_"))) +
geom_point(color = "darkgrey", alpha = 0.03) +
geom_point(
data = highlight_func,
color = "#006c66",
alpha = 0.3,
size = 1
) +
geom_density_2d(
data = highlight_func,
color = "#006c66"
) +
geom_density_2d(color = "#333333") +
guides(fill = "none") +
labs(
title = "Canonical Correlation Scores",
subtitle = "First component"
)
loadings_plt <-
ccas |>
filter((X == x_sphere & Y == y_sphere) | (X==y_sphere & Y == x_sphere)) |>
select(X, Y, loadings) |>
unnest(loadings) |>
unite(comp, X, Y) |>
ggplot(aes(var, CCA1)) +
geom_bar(
stat = "identity",
) +
coord_flip() +
facet_grid(comp ~ ., scales = "free_y", space = "free_y") +
labs(
x = "Feature",
y = "Loading",
title = paste0("Canonical Correlation Loadings ", paste(x_sphere, y_sphere, sep = "_"))
)
scores_plt | loadings_plt
ccas |>
filter((X == x_sphere & Y == y_sphere) | (X==y_sphere & Y == x_sphere)) |>
select(X, Y, scores) |>
unnest(scores) |>
unite(comp, X, Y) |>
ggplot(aes(CCA1, CCA2)) +
geom_point(
color = "darkgrey",
alpha = 0.03
) +
geom_point(
data = highlight_func,
color = "#006c66",
alpha = 0.3,
size = 1
) +
geom_density_2d(
data = highlight_func,
color = "#006c66"
) +
geom_density_2d(color = "#333333") +
facet_wrap(~comp) +
labs(title = "Canonical Correlation trajectories")
loadings_plt <-
ccas |>
filter((X == x_sphere & Y == y_sphere) | (X==y_sphere & Y == x_sphere)) |>
select(X, Y, loadings) |>
unnest(loadings) |>
unite(comp, X, Y) |>
ggplot(aes(var, CCA1)) +
geom_bar(
stat = "identity",
) +
coord_flip() +
facet_grid(comp ~ ., scales = "free_y", space = "free_y") +
labs(
x = "Feature",
y = "Loading",
title = "Canonical Correlation Loadings"
)
scores_plt | loadings_plt
ccas |>
filter((X == x_sphere & Y == y_sphere) | (X==y_sphere & Y == x_sphere)) |>
select(X, Y, scores) |>
unnest(scores) |>
unite(comp, X, Y) |>
ggplot(aes(CCA1, CCA2)) +
geom_point(
color = "darkgrey",
alpha = 0.03
) +
geom_point(
data = highlight_func,
color = "#006c66",
alpha = 0.3,
size = 1
) +
geom_density_2d(
data = highlight_func,
color = "#006c66"
) +
geom_density_2d(color = "#333333") +
facet_wrap(~comp) +
labs(title = "Canonical Correlation trajectories")
ccas |>
filter((X == x_sphere & Y == y_sphere) | (X==y_sphere & Y == x_sphere)) |>
select(X, Y, loadings) |>
unnest(loadings) |>
unite(comp, X, Y) |>
ggplot(aes(var, CCA1)) +
geom_bar(
stat = "identity",
) +
coord_flip() +
facet_grid(comp ~ ., scales = "free_y", space = "free_y") +
labs(
x = "Feature",
y = "Loading",
title = "Canonical Correlation Loadings"
)
ccas |>
filter((X == x_sphere & Y == y_sphere) | (X==y_sphere & Y == x_sphere)) |>
select(X, Y, loadings) |>
unnest(loadings) |>
unite(comp, X, Y) |>
ggplot(aes(var, CCA1)) +
geom_bar(
stat = "identity",
) +
coord_flip() +
facet_grid(comp ~ ., scales = "free_y", space = "free_y") +
theme(panel.grid.minor.x = TRUE)+
labs(
x = "Feature",
y = "Loading",
title = "Canonical Correlation Loadings"
)
ccas |>
filter((X == x_sphere & Y == y_sphere) | (X==y_sphere & Y == x_sphere)) |>
select(X, Y, loadings) |>
unnest(loadings) |>
unite(comp, X, Y) |>
ggplot(aes(var, CCA1)) +
geom_bar(
stat = "identity",
) +
coord_flip() +
facet_grid(comp ~ ., scales = "free_y", space = "free_y") +
theme(panel.grid.minor.x = element_line())+
labs(
x = "Feature",
y = "Loading",
title = "Canonical Correlation Loadings"
)
ccas |>
filter((X == x_sphere & Y == y_sphere) | (X==y_sphere & Y == x_sphere)) |>
select(X, Y, loadings) |>
unnest(loadings) |>
unite(comp, X, Y) |>
ggplot(aes(var, CCA1)) +
geom_bar(
stat = "identity",
) +
coord_flip() +
facet_grid(comp ~ ., scales = "free_y", space = "free_y") +
theme(panel.grid.minor.y = element_line())+
labs(
x = "Feature",
y = "Loading",
title = "Canonical Correlation Loadings"
)
ccas |>
filter((X == x_sphere & Y == y_sphere) | (X==y_sphere & Y == x_sphere)) |>
select(X, Y, loadings) |>
unnest(loadings) |>
unite(comp, X, Y) |>
ggplot(aes(var, CCA1)) +
geom_bar(
stat = "identity",
) +
coord_flip() +
facet_grid(comp ~ ., scales = "free_y", space = "free_y") +
theme(panel.grid.minor.y = element_line(), panel.grid.major = element_line())+
labs(
x = "Feature",
y = "Loading",
title = "Canonical Correlation Loadings"
)
ccas |>
filter((X == x_sphere & Y == y_sphere) | (X==y_sphere & Y == x_sphere)) |>
select(X, Y, loadings) |>
unnest(loadings) |>
unite(comp, X, Y) |>
ggplot(aes(var, CCA1)) +
geom_bar(
stat = "identity",
) +
coord_flip() +
facet_grid(comp ~ ., scales = "free_y", space = "free_y") +
theme(panel.grid.major.y = element_line())+
labs(
x = "Feature",
y = "Loading",
title = "Canonical Correlation Loadings"
)
ccas |>
filter((X == x_sphere & Y == y_sphere) | (X==y_sphere & Y == x_sphere)) |>
select(X, Y, loadings) |>
unnest(loadings) |>
unite(comp, X, Y) |>
ggplot(aes(var, CCA1)) +
geom_bar(
stat = "identity",
) +
coord_flip() +
facet_grid(comp ~ ., scales = "free_y", space = "free_y") +
theme(panel.grid.major.y = element_line(colour = "grey"))+
labs(
x = "Feature",
y = "Loading",
title = "Canonical Correlation Loadings"
)
loadings_plt <-
ccas |>
filter((X == x_sphere & Y == y_sphere) | (X==y_sphere & Y == x_sphere)) |>
select(X, Y, loadings) |>
unnest(loadings) |>
unite(comp, X, Y) |>
ggplot(aes(var, CCA1)) +
geom_bar(
stat = "identity",
) +
coord_flip() +
facet_grid(comp ~ ., scales = "free_y", space = "free_y") +
theme(panel.grid.major.y = element_line(colour = "grey"))+
labs(
x = "Feature",
y = "Loading",
title = "Canonical Correlation Loadings"
)
scores_plt | loadings_plt
