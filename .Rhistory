mutate(
# need to plot future points with transparency to fix camera position
state = ifelse(country == current_country & year <= current_year, "current", NA)
)
data2 |>
ggplot(aes(x = Biosphere, y = Atmosphere, z = Socioeconomics, color = state)) +
axes_3D() +
stat_3D(geom = "point", size = 2) +
stat_3D(geom = "path") +
labs_3D(label = c("Bio"," Atmo", "Soc"), hjust = 1.2) +
theme_void() +
theme(plot.subtitle = element_text(size = 6)) +
coord_fixed(xlim = 0.5*c(-1,1), ylim = 0.5*c(-1,1)) +
scale_color_manual(values = c("current" = "darkred"), na.value = "#00000000") +
guides(color = "none") +
labs(
title = str_glue("{current_country} {current_cca_axis}")
)
data2
data <-
list.files("data", full.names = TRUE) |>
map(read_csv) |>
bind_rows() |>
pivot_longer(starts_with("CC")) |>
mutate(
index_type = name |> str_extract("[XYZ]") |> recode("X" = "Biosphere", "Y" = "Atmosphere", Z = "Socioeconomics"),
cca_axis = name |> str_extract("[0-9]") |> map_chr(~ str_glue("CCA{.x}"))
) |>
select(-name) |>
rename(country = `Country Code`) |>
mutate(during_event = ! is.na(event)) |>
arrange(country, year)
data <-
list.files("data", full.names = TRUE) |>
map(read_csv) |>
bind_rows() |>
pivot_longer(starts_with("CC")) |>
mutate(
index_type = name |> str_extract("[XYZ]") |> recode("X" = "Biosphere", "Y" = "Atmosphere", Z = "Socioeconomics"),
cca_axis = name |> str_extract("[0-9]") |> map_chr(~ str_glue("CCA{.x}"))
) |>
select(-name) |>
rename(country = `Country Code`) |>
arrange(country, year)
data2 <-
data |>
pivot_wider(names_from = index_type, values_from = value) |>
filter(cca_axis == current_cca_axis) |>
mutate(
# need to plot future points with transparency to fix camera position
state = ifelse(country == current_country & year <= current_year, "current", NA)
)
data2 |>
ggplot(aes(x = Biosphere, y = Atmosphere, z = Socioeconomics, color = state)) +
axes_3D() +
stat_3D(geom = "point", size = 2) +
stat_3D(geom = "path") +
labs_3D(label = c("Bio"," Atmo", "Soc"), hjust = 1.2) +
theme_void() +
theme(plot.subtitle = element_text(size = 6)) +
coord_fixed(xlim = 0.5*c(-1,1), ylim = 0.5*c(-1,1)) +
scale_color_manual(values = c("current" = "darkred"), na.value = "#00000000") +
guides(color = "none") +
labs(
title = str_glue("{current_country} {current_cca_axis}")
)
data2
data |>
pivot_wider(names_from = index_type, values_from = value) |>
filter(cca_axis == current_cca_axis)
data2 <-
data |>
pivot_wider(names_from = index_type, values_from = value) |>
filter(cca_axis == current_cca_axis) |>
mutate(
# need to plot future points with transparency to fix camera position
state = ifelse(country == current_country & year <= current_year, "current", NA)
)
data2 |>
ggplot(aes(x = Biosphere, y = Atmosphere, z = Socioeconomics, color = state)) +
axes_3D() +
stat_3D(geom = "point", size = 2) +
stat_3D(geom = "path") +
labs_3D(label = c("Bio"," Atmo", "Soc"), hjust = 1.2) +
theme_void() +
theme(plot.subtitle = element_text(size = 6)) +
coord_fixed(xlim = 0.5*c(-1,1), ylim = 0.5*c(-1,1)) +
scale_color_manual(values = c("current" = "darkred"), na.value = "#00000000") +
guides(color = "none") +
labs(
title = str_glue("{current_country} {current_cca_axis}")
)
data2
data2 |> View()
data2 <-
data |>
pivot_wider(names_from = index_type, values_from = value) |>
filter(cca_axis == current_cca_axis & country == current_country )
data2 |>
ggplot(aes(x = Biosphere, y = Atmosphere, z = Socioeconomics, color = state)) +
axes_3D() +
stat_3D(geom = "point", size = 2) +
stat_3D(geom = "path") +
labs_3D(label = c("Bio"," Atmo", "Soc"), hjust = 1.2) +
theme_void() +
theme(plot.subtitle = element_text(size = 6)) +
coord_fixed(xlim = 0.5*c(-1,1), ylim = 0.5*c(-1,1)) +
scale_color_manual(values = c("current" = "darkred"), na.value = "#00000000") +
guides(color = "none") +
labs(
title = str_glue("{current_country} {current_cca_axis}")
)
data2 |>
ggplot(aes(x = Biosphere, y = Atmosphere, z = Socioeconomics)) +
axes_3D() +
stat_3D(geom = "point", size = 2) +
stat_3D(geom = "path") +
labs_3D(label = c("Bio"," Atmo", "Soc"), hjust = 1.2) +
theme_void() +
theme(plot.subtitle = element_text(size = 6)) +
coord_fixed(xlim = 0.5*c(-1,1), ylim = 0.5*c(-1,1)) +
scale_color_manual(values = c("current" = "darkred"), na.value = "#00000000") +
guides(color = "none") +
labs(
title = str_glue("{current_country} {current_cca_axis}")
)
plot <- function(current_cca_axis = "CCA2", current_country = "BRA") {
data2 <-
data |>
pivot_wider(names_from = index_type, values_from = value) |>
filter(cca_axis == current_cca_axis & country == current_country )
data2 |>
ggplot(aes(x = Biosphere, y = Atmosphere, z = Socioeconomics)) +
axes_3D() +
stat_3D(geom = "point", size = 2) +
stat_3D(geom = "path") +
labs_3D(label = c("Bio"," Atmo", "Soc"), hjust = 1.2) +
theme_void() +
theme(plot.subtitle = element_text(size = 6)) +
coord_fixed(xlim = 0.5*c(-1,1), ylim = 0.5*c(-1,1)) +
scale_color_manual(values = c("current" = "darkred"), na.value = "#00000000") +
guides(color = "none") +
labs(
title = str_glue("{current_country} {current_cca_axis}")
)
}
map(c("CCA1", "CCA2", "CCA3"), plot) |> wrap_plots()
map(c("CCA1", "CCA2", "CCA3"), c("BRA", "CHN"), plot) |> wrap_plots()
c("CCA1", "CCA2", "CCA3"), c("BRA", "CHN")
map2(c("CCA1", "CCA2", "CCA3"), c("BRA", "CHN"), plot) |> wrap_plots()
?map2
expand_grid(
cca_axis = c("CCA1", "CCA2", "CCA3"),
country = c("BRA", "CHN", "NER")
)
expand_grid(
cca_axis = c("CCA1", "CCA2", "CCA3"),
country = c("BRA", "CHN", "NER")
) |>
mutate(plt = map2(cca_axis, country, ~ plot(.x, .y)))
expand_grid(
cca_axis = c("CCA1", "CCA2", "CCA3"),
country = c("BRA", "CHN", "NER")
) |>
mutate(plt = map2(cca_axis, country, ~ plot(.x, .y))) |>
pull(plt) |>
wrap_plots()
plot <- function(current_cca_axis = "CCA2", current_country = "BRA") {
data2 <-
data |>
pivot_wider(names_from = index_type, values_from = value) |>
filter(cca_axis == current_cca_axis & country == current_country )
data2 |>
ggplot(aes(x = Biosphere, y = Atmosphere, z = Socioeconomics)) +
axes_3D() +
stat_3D(geom = "point", size = 2) +
stat_3D(geom = "path") +
labs_3D(label = c("Bio"," Atmo", "Soc"), hjust = 1.2) +
theme_void() +
theme(plot.subtitle = element_text(size = 6)) +
coord_fixed(xlim = 0.5*c(-1,1), ylim = 0.5*c(-1,1)) +
guides(color = "none") +
labs(
title = str_glue("{current_country} {current_cca_axis}")
)
}
expand_grid(
cca_axis = c("CCA1", "CCA2", "CCA3"),
country = c("BRA", "CHN", "NER")
) |>
mutate(plt = map2(cca_axis, country, ~ plot(.x, .y))) |>
pull(plt) |>
wrap_plots()
plot <- function(current_cca_axis = "CCA2", current_country = "BRA") {
data |>
pivot_wider(names_from = index_type, values_from = value) |>
filter(cca_axis == current_cca_axis & country == current_country ) |>
ggplot(aes(x = Biosphere, y = Atmosphere, z = Socioeconomics)) +
axes_3D() +
stat_3D(geom = "point", size = 2) +
stat_3D(geom = "path") +
labs_3D(label = c("Bio"," Atmo", "Soc"), hjust = 1.2) +
theme_void() +
theme(plot.subtitle = element_text(size = 6)) +
coord_fixed(xlim = 0.5*c(-1,1), ylim = 0.5*c(-1,1)) +
guides(color = "none") +
labs(
title = str_glue("{current_country} {current_cca_axis}")
)
}
plot <- function(current_cca_axis = "CCA2", current_country = "BRA") {
data |>
pivot_wider(names_from = index_type, values_from = value) |>
filter(cca_axis == current_cca_axis & country == current_country ) |>
ggplot(aes(x = Biosphere, y = Atmosphere, z = Socioeconomics)) +
axes_3D() +
stat_3D(geom = "point", size = 2) +
stat_3D(geom = "path") +
labs_3D(label = c("Bio"," Atmo", "Soc"), hjust = 1.2) +
theme_void() +
theme(plot.subtitle = element_text(size = 6)) +
coord_fixed(xlim = 0.5*c(-1,1), ylim = 0.5*c(-1,1)) +
guides(color = "none") +
labs(
title = str_glue("{current_country} {current_cca_axis}")
)
}
expand_grid(
cca_axis = c("CCA1", "CCA2", "CCA3"),
country = c("BRA", "CHN", "NER")
) |>
mutate(plt = map2(cca_axis, country, ~ plot(.x, .y))) |>
pull(plt) |>
wrap_plots()
data |>
pivot_wider(names_from = index_type, values_from = value) |>
filter(cca_axis == current_cca_axis & country == current_country )
plot <- function(current_cca_axis = "CCA2", current_country = "BRA") {
data |>
pivot_wider(names_from = index_type, values_from = value) |>
filter(cca_axis == current_cca_axis & country == current_country ) |>
ggplot(aes(x = Biosphere, y = Atmosphere, z = Socioeconomics)) +
axes_3D() +
stat_3D(geom = "point", size = 2) +
stat_3D(geom = "path") +
labs_3D(label = c("Bio"," Atmo", "Soc"), hjust = 1.2) +
theme_void() +
theme(plot.subtitle = element_text(size = 6)) +
coord_fixed(xlim = 0.5*c(-1,1), ylim = 0.5*c(-1,1)) +
guides(color = "none") +
labs(
title = str_glue("{current_country} {current_cca_axis}")
)
}
expand_grid(
cca_axis = c("CCA1", "CCA2", "CCA3"),
country = c("BRA", "CHN", "NER")
) |>
mutate(plt = map2(cca_axis, country, ~ plot(.x, .y))) |>
pull(plt) |>
wrap_plots()
data |>
pivot_wider(names_from = index_type, values_from = value) |>
filter(cca_axis == current_cca_axis & country == current_country ) |>
arrange(year) |>
ggplot(aes(x = Biosphere, y = Atmosphere, z = Socioeconomics)) +
axes_3D() +
stat_3D(geom = "point", size = 2) +
stat_3D(geom = "path") +
labs_3D(label = c("Bio"," Atmo", "Soc"), hjust = 1.2) +
theme_void() +
theme(plot.subtitle = element_text(size = 6)) +
coord_fixed(xlim = 0.5*c(-1,1), ylim = 0.5*c(-1,1)) +
guides(color = "none") +
labs(
title = str_glue("{current_country} {current_cca_axis}")
)
plot <- function(current_cca_axis = "CCA2", current_country = "BRA") {
data |>
pivot_wider(names_from = index_type, values_from = value) |>
filter(cca_axis == current_cca_axis & country == current_country ) |>
arrange(year) |>
ggplot(aes(x = Biosphere, y = Atmosphere, z = Socioeconomics)) +
axes_3D() +
stat_3D(geom = "point", size = 2) +
stat_3D(geom = "path") +
labs_3D(label = c("Bio"," Atmo", "Soc"), hjust = 1.2) +
theme_void() +
theme(plot.subtitle = element_text(size = 6)) +
coord_fixed(xlim = 0.5*c(-1,1), ylim = 0.5*c(-1,1)) +
guides(color = "none") +
labs(
title = str_glue("{current_country} {current_cca_axis}")
)
}
expand_grid(
cca_axis = c("CCA1", "CCA2", "CCA3"),
country = c("BRA", "CHN", "NER")
) |>
mutate(plt = map2(cca_axis, country, ~ plot(.x, .y))) |>
pull(plt) |>
wrap_plots()
ggsave("out/cca-country.png")
plot <- function(current_cca_axis = "CCA2", current_country = "BRA") {
data |>
pivot_wider(names_from = index_type, values_from = value) |>
filter(cca_axis == current_cca_axis & country == current_country ) |>
arrange(year) |>
ggplot(aes(x = Biosphere, y = Atmosphere, z = Socioeconomics)) +
axes_3D() +
stat_3D(geom = "point", size = 2) +
stat_3D(geom = "path") +
labs_3D(label = c("Bio"," Atmo", "Soc"), hjust = 1.2) +
theme_void() +
theme(plot.subtitle = element_text(size = 6)) +
coord_fixed(xlim = 0.5*c(-1,1), ylim = 0.5*c(-1,1)) +
guides(color = "none") +
labs(
title = str_glue("{current_country} {current_cca_axis}")
)
}
expand_grid(
cca_axis = c("CCA1", "CCA2", "CCA3"),
country = c("BRA", "CHN", "NER")
) |>
mutate(plt = map2(cca_axis, country, ~ plot(.x, .y))) |>
pull(plt) |>
wrap_plots()
ggsave("out/cca-country.png")
ggsave("out/cca-country.png", width = 10)
ggsave("out/cca-country.png", width = 10, height = 10)
plot <- function(current_cca_axis = "CCA2", current_country = "BRA") {
data |>
pivot_wider(names_from = index_type, values_from = value) |>
filter(cca_axis == current_cca_axis & country == current_country ) |>
arrange(year) |>
ggplot(aes(x = Biosphere, y = Atmosphere, z = Socioeconomics, alpha = year)) +
axes_3D() +
stat_3D(geom = "point", size = 2) +
stat_3D(geom = "path") +
labs_3D(label = c("Bio"," Atmo", "Soc"), hjust = 1.2) +
theme_void() +
theme(plot.subtitle = element_text(size = 6)) +
coord_fixed(xlim = 0.5*c(-1,1), ylim = 0.5*c(-1,1)) +
guides(color = "none") +
labs(
title = str_glue("{current_country} {current_cca_axis}")
)
}
expand_grid(
cca_axis = c("CCA1", "CCA2", "CCA3"),
country = c("BRA", "CHN", "NER")
) |>
mutate(plt = map2(cca_axis, country, ~ plot(.x, .y))) |>
pull(plt) |>
wrap_plots()
expand_grid(
cca_axis = c("CCA1", "CCA2", "CCA3"),
country = c("BRA", "CHN", "NER")
) |>
mutate(plt = map2(cca_axis, country, ~ plot(.x, .y))) |>
pull(plt) |>
wrap_plots(guides = "collect")
?wrap_plots
expand_grid(
cca_axis = c("CCA1", "CCA2", "CCA3"),
country = c("BRA", "CHN", "NER")
) |>
mutate(plt = map2(cca_axis, country, ~ plot(.x, .y))) |>
pull(plt) |>
wrap_plots(guides = "collect")
expand_grid(
cca_axis = c("CCA1", "CCA2", "CCA3"),
country = c("BRA", "CHN", "NER")
) |>
mutate(plt = map2(cca_axis, country, ~ plot(.x, .y))) |>
pull(plt) |>
wrap_plots()
ggsave("out/cca-country.png", width = 10, height = 10)
iris |>
ggplotly()
library(shiny)
library(tidyverse)
library(bslib)
library(plotly)
library(ggnewscale)
iris |>
ggplotly()
?ggplotly
iris
iris |>
ggplot(aes(Sepal.Length, Sepal.Width, Petal.Length)) +
geom_point()
ggplotly()
plt <-
iris |>
ggplot(aes(Sepal.Length, Sepal.Width, Petal.Length)) +
geom_point()
ggplotly(plt)
?ggplotly
plot_ly(
type = "scatter3d",
mode = "markers",
data = iris,
x = ~ Sepal.Length,
y = ~ Sepal.Width,
z = ~ Petal.Length
)
runApp()
data
current_data() |>
filter(cca_axis == "CCA1") |>
pivot_wider(names_from = index_type, values_from = value)
data <-
current_data() |>
filter(cca_axis == "CCA1") |>
pivot_wider(names_from = index_type, values_from = value)
data+
1
data
1+1
runApp()
runApp()
runApp()
runApp()
?plot_ly
runApp()
runApp()
runApp()
?page_navbar
?bs_theme
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
?plot_ly
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
library(ggsci)
runApp()
runApp()
pal_npg()
pal_npg()(10)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
?nav_panel
runApp()
runApp()
?layout_sidebar
runApp()
?nav_panel
runApp()
?nav_panel
runApp()
runApp()
runApp()
runApp()
?page_navbar
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
data
runApp()
runApp()
shiny::runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
